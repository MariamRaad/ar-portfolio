<!DOCTYPE html>
<html>

<head>
    <title>AR Portfolio - Mariam Raad</title>
    <link rel="icon" type="image/png" href="assets/images/favicon/favicon.png">

    <!--  this is REQUIRED for iOS -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <!-- , minimum-scale=1.0, maximum-scale=2.0 -->
    <meta name="viewport" content="width=device-width, user-scalable=no">

    <!-- AFrame -->
    <!-- <script src="https://aframe.io/releases/1.0.4/aframe.min.js    https://cdn.jsdelivr.net/gh/aframevr/aframe@cd01cec35a01e03eb2d6a9272500a53de31d3828/dist/aframe-master.min.js"></script> -->
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>

    <!-- aFrameByCode enables scene management -->
    <!-- <script src="https://faace.github.io/aFrameByCode/dist/aFrameByCode.min.js"></script> -->

    <!-- ARjs -->
    <!-- Version without NFT/image tracking but with marker + location based support -->
    <!-- <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script> -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/3.1.0/aframe/build/aframe-ar.js"></script>

    <!-- Other Dependencies -->
    <script src="https://cdn.rawgit.com/donmccurdy/aframe-extras/v4.1.2/dist/aframe-extras.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>

    <!-- import the webpage's stylesheet -->
    <link rel="stylesheet" href="https://mariamraad.github.io/ar-portfolio/style.css">
    <!-- https://mariamraad.github.io/ar-portfolio/style.css -->
    <!-- /style.css -->

    <!-- import Scripts to add functionality -->
    <script src="https://mariamraad.github.io/ar-portfolio/events.js"></script>
    <!-- <script src="https://mariamraad.github.io/ar-portfolio/cursor.js" defer></script> -->
    <!-- the "defer" attribute tells the browser that the script is meant to be executed after the document has been parsed -->

	<!--
    <script>
      //window.addEventListener('videohandler', function () {
      window.onload = function() {
	AFRAME.registerComponent('videohandler', {
  	  init: function () {
    	    var marker = document.querySelector("#marker"); //const
	    var scanner = document.querySelector("#scanner"); //const
    	    var video = document.querySelector("#Video_Asset_0"); //this.video

    	    marker.addEventListener('markerFound', function () {
		  scanner.hidden = true;
	          this.video.play(); //this.vid.play();
    	    }.bind(this));
    
	    marker.addEventListener('markerLost', function () {
		  scanner.hidden = false;
		  this.video.pause(); //this.vid.pause();
		  // this.vid.currentTime = 0;
            }.bind(this));
  	  }
       });
    }
    </script>
-->
	
    <!-- Click-Function to pause and/or start a video -->
    <!-- this is REQUIRED for iOS -->
    <script>
	    	var scene
		var AR-VideoScreen

		AFRAME.registerComponent('markerhandler', {
			init: function() {

    			// Set up the tick throttling. Will check if marker is active every 500ms
   			this.tick = AFRAME.utils.throttleTick(this.tick, 500, this);
  			},

  			tick: function(t, dt) {
				if (document.querySelector("#marker").object3D.visible == true && playing == false) {
      				//MARKER IS PRESENT
     				//alert("MARKER IS PRESENT")

  				scene = document.querySelector('#scene1');
      				AR-VideoScreen =  document.querySelector('#videoScreen');

      				videoScreen.addEventListener('click', function () { playPauseVideo(); console.log("Video Play Toggle") });
      				playing = true;
				}
				} else {
      				// MARKER IS HIDDEN, do nothing (up to you)
    			}

		});

		function playPauseVideo(){
			if (video.paused)
    				video.play();
  			else
    				video.pause();
		}

	    /*
	var video1 = document.querySelector("#Video_Asset_0");
	
	AFRAME.registerComponent("clickhandler", {
  		init: function() {
    			this.el.addEventListener('click', function(evt) {
    			console.log("CLICK ON");
			    video1.play();
    			});
  		}
	});    
*/ 
	    
	    //TODO: condition changing to: when markerIsFound AND clicked
	    /*
        window.addEventListener('click', function () {
            var video = document.querySelector('#Video_Asset_0');
                if (video.paused == true) {
                    video.play();
                } else {
                    video.pause();
                }
        }, false);
	*/
    </script>
</head>

<body> <!-- style="margin: 0px; overflow: hidden;" -->
    <!-- Logo -->
    <div class="logoWrapper">
    	    <input id="logo" type="image" class="logoImage" src="https://mariamraad.github.io/ar-portfolio/assets/images/logo/Logo_MandR_Schrift.png"></input>
  	</div>
	
    <!-- Scanner Bild -->	
    <div class="scannerWrapper">
	<input id="scanner" type="image" class="scannerImage" src="https://mariamraad.github.io/ar-portfolio/assets/images/scanner/Scanner_ohneHintergrund_Text.png"/>
    </div>
	
    <a-scene id="scene1" vr-mode-ui="enabled: false;" renderer="antialias: true; alpha: true; precision: mediump;" embedded arjs="trackingMethod: best; sourceType: webcam; debugUIEnabled: false; patternRatio: 0.8">
       
	<!-- <a-entity id="mouseCursor" cursor="rayOrigin: mouse" raycaster="objects: .intersectable;"></a-entity> -->
	
	<a-assets>
            <!-- <img id="my-image" src="https://mariamraad.github.io/ar-portfolio/assets/images/batman.jpg"> -->
            <video id="Video_Asset_0" src="https://mariamraad.github.io/ar-portfolio/assets/videos/SafeNetKids_compressed.mp4" type="video/mp4" preload="auto" response-type="arraybuffer" loop crossorigin webkit-playsinline autoplay playsinline></video>
        </a-assets>

        <!-- <a-marker-camera preset='hiro' registerevents   cursor="rayOrigin: mouse" -->
        <!-- cursor="rayOrigin: mouse; fuse: true; fuseTimeout: 0;" raycaster="objects: [clickhandler]; raycaster="objects: .intersectable" -->
	<!-- scannerhandler -->
        <a-marker markerhandler  emitevents="true" id="marker" cursor="fuse: false; rayOrigin: mouse" raycaster="objects: [clickhandler]" preset="custom" type="pattern" url="https://mariamraad.github.io/ar-portfolio/assets/images/markers/pattern.patt" smooth="true" smoothCount="10" smoothTolerance="0.02" smoothThreshold="2">
		<a-entity>
			<!--
			id="vidddeo" 
			a-video="#Video_Asset_0" 
			position="0 0.5 0" 
			rotation="270 0 0" 
			width="2" 
			height="1.5" 
			play="true"
			-->
			
			<!-- clickhandler -->
			<a-video id="videoScreen" src="#Video_Asset_0" position="0 0.5 0" rotation="270 0 0" width="2" height="1.5" ></a-video> <!--play="true" -->
            	
	        </a-entity>
			
		<!-- <a-image position="0 2 0" rotation ="0 0 0" width="2" height="1" src="#my-image"></a-image> -->
        </a-marker>
	    
	<!-- static camera that moves according to the device movemenents -->
        <a-entity camera>
	   <!-- <a-entity cursor="rayOrigin: mouse;fuse: false;" raycaster="objects: [clickhandler];"></a-entity> -->
	</a-entity>
	    
    </a-scene>
</body>

</html>
